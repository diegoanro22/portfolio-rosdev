"use client";
import React, { useState } from "react";
import { useRouter } from "next/navigation";
import { motion } from "framer-motion";

const VinylPlayer = () => {
  const [armMoved, setArmMoved] = useState(false);
  const [isSpinning, setIsSpinning] = useState(false);
  const router = useRouter();

  const handleClick = () => {
    if (armMoved) return; // evita múltiples clicks
    setArmMoved(true);

    // Después de 1.5s redirigimos (el vinilo estará girando para entonces)
    setTimeout(() => {
      router.push("/");
    }, 1500);
  };

  return (
    <div className="flex items-center justify-center min-h-screen bg-gray-100">
      <svg
        onClick={handleClick}
        className="w-96 h-auto cursor-pointer"
        viewBox="0 0 600 450"
        preserveAspectRatio="xMidYMid meet"
        xmlns="http://www.w3.org/2000/svg"
      >
        {/* Fondo */}
        <rect width="800" height="450" fill="#F5F5F5" />

        {/* Grupo del vinilo: gira solo cuando isSpinning = true */}
        <motion.g
          initial={{ rotate: 0 }}
          animate={isSpinning ? { rotate: 360 } : { rotate: 0 }}
          transition={
            isSpinning
              ? { repeat: Infinity, duration: 2, ease: "linear" }
              : { duration: 0 }
          }
          transform="rotate(0 250 225)"
        >
          <circle cx="250" cy="225" r="210" fill="#949494" />
          <circle id="Shadow" cx="250" cy="229" r="190" fill="#80807F" />
          <circle cx="250" cy="225" r="190" fill="#2C2C2E" />
          <g>
            <path
              fill="#3D3D3F"
              d="M372.124,79.458L250,225L127.876,79.458C144.687,65.337,163.973,54.068,185,46.414
                 C205.279,39.031,227.168,35,250,35s44.721,4.031,65,11.414C336.026,54.068,355.313,65.337,372.124,79.458z
                 M127.876,370.542c16.811,14.121,36.098,25.389,57.124,33.044C205.279,410.969,227.168,415,250,415
                 s44.721-4.031,65-11.414c21.026-7.655,40.313-18.923,57.124-33.044L250,225L127.876,370.542z"
            />
          </g>
          <g>
            <path
              fill="#535357"
              d="M299.186,41.435L250,225L200.814,41.435C216.502,37.241,232.989,35,250,35
                 S283.498,37.241,299.186,41.435z M250,225L250,225l-49.186,183.565C216.502,412.759,232.989,415,250,415
                 s33.498-2.241,49.186-6.435L250,225L250,225z"
            />
          </g>
          <path
            fill="#131114"
            d="M250,383.167c-87.213,0-158.167-70.953-158.167-158.167
               c0-87.213,70.953-158.167,158.167-158.167c87.214,0,158.167,70.953,158.167,158.167
               C408.167,312.214,337.214,383.167,250,383.167z M250,69.834c-85.559,0-155.167,69.607-155.167,155.167
               c0,85.56,69.607,155.167,155.167,155.167c85.56,0,155.167-69.607,155.167-155.167
               C405.167,139.441,335.56,69.834,250,69.834z"
          />
          <path
            fill="#131114"
            d="M250,349.833c-68.833,0-124.834-56-124.834-124.833
               c0-68.833,56-124.834,124.834-124.834c68.833,0,124.833,56,124.833,124.834
               C374.833,293.833,318.833,349.833,250,349.833z M250,103.166c-67.179,0-121.833,54.654-121.833,121.834
               c0,67.179,54.654,121.833,121.833,121.833c67.179,0,121.833-54.654,121.833-121.833
               C371.833,157.821,317.179,103.166,250,103.166z"
          />
          <circle fill="#131114" cx="250" cy="225" r="90" />

          {/* Centro azul */}
          <circle fill="#0000FF" cx="250" cy="225" r="65" />
          <circle fill="#FFFFFF" cx="250" cy="225" r="7.5" />
        </motion.g>

        {/* Grupo de la aguja: permanece visible incluso durante la rotación */}
        <motion.g
          initial={{ rotate: -30 }}
          animate={armMoved ? { rotate: 85 } : { rotate: 0 }}
          transition={{ type: "spring", stiffness: 300, damping: 20 }}
          onAnimationComplete={() => {
            if (armMoved && !isSpinning) {
              setIsSpinning(true);
            }
          }}
          transform="rotate(0 505 95)"
          style={{ transformOrigin: "505px 95px" }}
        >
          <circle fill="#2C2C2E" cx="505" cy="95" r="50" />
          <path
            fill="#DBDBDB"
            d="M514.572,286.435c0,0-16.098,10.371-16.925,33.435c-0.708,19.771-0.738,20.471-36.357,68.263
               c-3.645-0.249-7.374,1.022-10.147,3.824c-0.079,0.072-21.988,22.729-21.988,22.729
               c-1.525,1.536-1.538,4.011-0.036,5.572l12.555,13.028c1.557,1.608,4.131,1.632,5.703,0.041c0,0,6.041-6.267,11.833-12.275
               l2.077,1.984l0,0l11.653,11.133c1.198,1.145,3.097,1.101,4.241-0.097s1.101-3.097-0.097-4.242l-7.112-6.795l0,0
               l-6.598-6.304c3.536-3.668,6.263-6.497,6.287-6.523c2.785-2.83,4.001-6.611,3.673-10.278c38.548-51.708,40.111-54.334,41.01-79.462
               C515.185,296.998,514.648,292.154,514.572,286.435z"
          />
          <path
            fill="#949494"
            d="M477.084,404.48l-16.681-15.936l-4.145,4.338l16.681,15.936
               c1.198,1.145,3.097,1.101,4.241-0.097l0,0C478.325,407.524,478.282,405.625,477.084,404.48z"
          />
          <path
            fill="#949494"
            d="M513.356,112.345l-16.705,0.22c0.017,1.396,1.823,158.891,0.996,181.954
               c-0.734,20.49-0.734,20.49-40.379,73.656l0,0c-1.31,1.758-0.947,4.245,0.811,5.556l7.031,5.241
               c1.757,1.31,4.243,0.947,5.553-0.81l0,0c41.155-55.193,42.762-57.347,43.681-83.045C515.185,271.648,513.432,118.064,513.356,112.345z"
          />
          <path
            fill="#949494"
            d="M513.737,98.013c11.036-31.153,21.961-62.354,26.076-74.123
               c0.912-2.608-0.464-5.46-3.072-6.371l-6.333-2.211c-2.606-0.91-5.455,0.46-6.366,3.065
               c-4.057,11.597-14.989,42.806-26.011,73.923L513.737,98.013z"
          />
          <path
            fill="#535357"
            d="M542.237,26.589c0,0-14.457-5.501-21.215-8.075c-2.631-1.002-5.563,0.368-6.493,3.025
               L503.653,52.57c-0.922,2.556,0.367,5.38,2.901,6.36l21.186,8.189c2.617,1.012,5.554-0.328,6.506-2.968l10.942-31.254
               C546.071,30.343,544.764,27.548,542.237,26.589z"
          />
          <path
            fill="#C4C4C4"
            d="M512.544,27.204l-4.824,13.764l30.514,11.795l4.875-13.925
               C534.224,35.457,522.392,30.954,512.544,27.204z"
          />
          <circle fill="#C4C4C4" cx="505" cy="95" r="25" />
          <path
            fill="#949494"
            d="M488.854,75.92c-3.41,2.889-6.033,6.674-7.509,10.994l17.388,17.547
               l0.005-0.005c1.962,1.904,4.783,2.927,7.831,2.411c3.695-0.626,6.74-3.593,7.298-7.299
               c0.27-1.792,0.133-3.715,0.133-3.715L488.854,75.92z"
          />
          <path
            fill="#F5F5F5"
            d="M511.456,88.738l0.005-0.005L485.71,62.747c-1.953-1.953-5.118-1.953-7.071,0
               l-5.657,5.657c-1.953,1.953-1.953,5.118,0,7.071l25.751,25.986l0.005-0.005
               c1.962,1.904,4.783,2.927,7.831,2.411c3.695-0.626,6.672-3.604,7.298-7.299
               C514.383,93.52,513.36,90.7,511.456,88.738z"
          />
          <circle fill="#C4C4C4" cx="532.211" cy="119.378" r="7.5" />
          <path
            fill="#535357"
            d="M469.661,384.859c-0.069,0.073-22.284,23.118-22.284,23.118
               c-1.572,1.591-4.146,1.567-5.703-0.041l-12.555-13.028c-1.502-1.562-1.489-4.036,0.036-5.572
               c0,0,21.909-22.657,21.988-22.729c5.045-5.098,13.256-5.161,18.365-0.135
               C474.627,371.509,474.698,379.74,469.661,384.859z"
          />
        </motion.g>
      </svg>

      {/* Texto en pantalla */}
      <div className="absolute bottom-10 text-center">
        <p className="text-gray-600 text-lg">
          {isSpinning
            ? "Cargando portafolio..."
            : armMoved
            ? "Acercando aguja..."
            : "Haz clic para comenzar"}
        </p>
      </div>
    </div>
  );
};

export default VinylPlayer;
